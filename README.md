


<p>这是一个完整的“虚拟人直播带货+直播答疑”系统。<br></p>
<p>
文生图模型：太乙<br>
文生语音模型：chattts<br>
口型与驱动模型：Wav2Lip<br>
</p><br><br><br>



**<p> 日志输出示例：<br>**
<img width="733" height="576" alt="image" src="https://github.com/user-attachments/assets/3b55e5bb-fecd-477d-9e23-29b1ffed9109" />
</p>


**<p>技术架构如下：</p>**

**<p> 分层：<br>**
1. 内容层<br>
主播放脚本：切成若干片段（每10秒左右一段），例如“开场→卖点1→卖点2→价格→优惠→收尾”<br>
FAQ语料：可回答的问题（如价格、度数、产地等）<br>
开放问答：不在FAQ里的问题，交给LLM生成短答（限长、限时、限安全范围）<br>
2. 理解层<br>
分类：这条弹幕是不是和本场直播的商品相关？<br>
匹配：若分类判定为相关，能否命中FAQ？<br>
策略：输出 { action = Rhetorical|Answer_Now|Ignore|Defer }<br>
3. 编排层<br>
轨道：分“主讲轨”和“答疑轨”，“主讲轨”不断地播放片段，“答疑轨”在片段与片段之间以预设插槽的形式介入。<br>
节拍表（timeline）：“主讲轨”在每个片段之间/中，是否允许插槽？<br>
队列：将多个要回答的弹幕放进答疑队列，按优先级调度（例如：命中FQA>高置信度开放问答>其它）<br>
节流与冷却：控制每时长最多回答X个问题，或者某用户的问题冷却Y秒。<br>
延迟策略：在下一个可插入槽点判断是否回答Defer问题，或者判断出在某时刻回答Defer问题。<br>
4. 合成层<br>
语音：TTS合成或者声音克隆。（MS）<br>
口型/头像：静态头像（每个片段都是一个mp4），或者逼真头像（效果好，但因为较长，延迟极高）<br>
播放器：顺序播放轨道A/B输出的mp4片段......
<br></p><br>




**<p> 决策规则：<br>**
[输入]：一条弹幕（文本）<br>
[输出]：一个动作 + 可能回答的文本<br>
优先级/优化：
1. 安全/敏感拦截（涉政、人身攻击、违规词）→ IGNORE（用户ID禁言）<br>
2. 相关性<阈值（与本场商品无关）→ IGNORE<br>
3. 命中FAQ → Answer_Now（若当前片段可插播，否则DEFER）<br>
4. 高置信开放问答（LLM生成≤50字）→ Answer_Now / DEFER<br>
5. 其它 → IGNORE（例如，UI展示“感谢提问，稍后统一解答”文本，不播语音）<br>

速率控制/优化：
1. 防刷屏：如每30秒最多回答1条问题<br>
2. 长回答：只能在“问答插槽”中播放<br>
</p><br>







